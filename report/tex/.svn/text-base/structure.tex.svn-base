\section{Structure}
A game is defined by its rules. Because of this, rules must be a mandatory input to the game engine. At page ???\todo{ref} it is defined that the game engine executes games with two participants. Each of these participants can be either a human player or controlled by an AI script which is selected as input to the game engine. An abstract diagram of these inputs are shown in figure \ref{fig:inputs}.

\begin{figure}[H]
\centering
\includegraphics[width=0.8\linewidth]{img/structure.png}
\caption{Diagram of the inputs to our game engine}
\label{fig:inputs}
\end{figure}

The language KAPAOOW is able to describe the rules and the optional AI of a game. The order of which the code for win conditions, AI, and so on is executed is shown in figure \ref{fig:order}.

\begin{figure}[H]
\centering
\includegraphics[width=1\linewidth]{img/order.png}
\caption{The order of execution in a game}
\label{fig:order}
\end{figure}

The code first executed in a game is the "start" block defined in the rules. This block can used to set special game variables or select which of the participants has the first turn in the game.

The next blocks executed are the "turn begins"-blocks. There are two of these: a general and a character block. The general is the first executed and will execute no matter which character is selected by the current player. The character block is a special code block that can be defined for each character in the game and can for example be used to define whether a character regenerates health at the beginning of its turn or other special characteristics of a character.

If the current player is AI-controlled the code for the AI is now executed. But if the current player is a human then the game will pause and allow the player to select which actions to perform through a graphical user interface. When the player chooses to end the turn the game engine will continue with the "Turn ends"-blocks.

The "Turn ends"-blocks are like the "turn begins"-blocks but with the difference that the character block is executed before the general block. After these blocks has been executed a new turn will begin with the other participant selected as the current player.

The game ends when one of the code blocks, except the human and AI, specifies that the current player wins, the enemy wins, or the game is drawn.

It is also important to note that while the human and AI is only able to execute actions defined in the selected character, every other code block are able to make changes to all game variables. This is because everything except the human and AI actions are a part of the rules. If humans or AI where allowed to change the game variables, it would be possible to cheat in whatever game they are playing.