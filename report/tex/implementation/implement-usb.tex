\section{USB protocol}
The USB protocol has been implemented exactly as it has been described in \autoref{sec:design-usb}.

When the Kinect has found the coordinates and speed vector of the target, this data will be sent to the NXT. \autoref{lst:usbpy} shows each coordinate for the position and the speed vector being converted to an array of chars, so that they can be sent over USB. The function convert handles this convertion. Every coordinate is turned into an array of three items, which are combined in the function send\_data to one array containing all the data, 18 items in total. 

\lstinputlisting[language=Python, caption=Conversion of target position and speed vector. File: usbcom.py, label=lst:usbpy]{listings/usb-py.py}

When the NXT has received the data, it will be converted from the char array into integers. \autoref{lst:usbc} shows part of the task TaskKinect, where each part of the target position and the speed vector is being converted back from the array of chars to integers. Each of the parts joins three elements from the array to make the integer. 
The event EvTargetAcquired is set to true, so that the task TaskAim will start once TaskKinect is terminated.

\lstinputlisting[language=C, caption=NXT conversion of array to ints. File: launcher.c, label=lst:usbc]{listings/usb-nxt.c}